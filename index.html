<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V2R Builds - Transforming Vision to Reality</title>
    <meta name="description"
        content="V2R Builds revolutionizes home renovation with 3D renderings, accurate estimates, and a vetted contractor network in Boston and Framingham.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@400;500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="images/favicon.png">
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container nav-container">
            <div class="nav-left">
                <a href="#" class="logo">
                    <img src="images/favicon.png" alt="V2R Logo" class="logo-icon">
                    V2R <span class="highlight">Builds</span>
                </a>
                <ul class="nav-links desktop-only">
                    <li><a href="#approach">Why V2R?</a></li>
                    <li><a href="#what-you-get">What You Get</a></li>
                    <li><a href="#packages">Pricing</a></li>
                </ul>
            </div>
            <div class="nav-right">
                <a href="vision.html" class="btn-primary nav-btn desktop-only">Try Estimator</a>
                <div class="hamburger">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu">
        <a href="#approach" class="mobile-link">Why V2R?</a>
        <a href="#what-you-get" class="mobile-link">What You Get</a>
        <a href="#packages" class="mobile-link">Pricing</a>
        <a href="vision.html" class="btn-primary mobile-btn">Try Estimator</a>
    </div>

    <!-- Hero Section -->
    <header class="hero">
        <video autoplay muted loop playsinline preload="auto" class="hero-video" poster="images/hero.png">
            <source src="videos/hero.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <h1 class="animate-fade-in">Get a Visualized Estimate in 30 Seconds</h1>
            <h2 class="animate-slide-up" style="animation-delay: 0.2s;">Vision to Reality</h2>

            <div class="hero-buttons animate-slide-up" style="animation-delay: 0.6s;">
                <a href="vision.html" class="btn-primary">
                    <i class="fa-solid fa-wand-magic-sparkles"></i> Try Estimator
                </a>

            </div>
        </div>
    </header>

    <!-- Value Gap & Solution Section -->
    <section class="value-gap-section" style="padding: 5rem 0; background: white;">
        <div class="container">
            <h2 class="section-title" style="text-align: center; font-size: 2.5rem; margin-bottom: 3rem;">Get a
                Visualized Estimate in 30 Seconds</h2>

            <!-- Flow Chart -->
            <div class="gap-grid"
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin-bottom: 5rem; position: relative;">

                <!-- Step 1: The Gap -->
                <div class="gap-card" style="text-align: center; padding: 2rem;">
                    <h3
                        style="color: var(--text-secondary); font-size: 0.9rem; letter-spacing: 1px; text-transform: uppercase; margin-bottom: 0.5rem;">
                        The Gap:</h3>
                    <h4 style="color: #ef4444; font-size: 1.5rem; font-weight: 800; margin-bottom: 1.5rem;">LOSING JOBS
                    </h4>
                    <div class="gap-icon"
                        style="height: 120px; display: flex; align-items: center; justify-content: center; margin-bottom: 1.5rem;">
                        <i class="fa-solid fa-hourglass-end"
                            style="font-size: 4rem; color: var(--text-secondary); opacity: 0.5;"></i>
                    </div>
                    <p style="font-weight: 700; margin-bottom: 0.5rem;">Stop Losing Jobs Because Your Estimate Takes Too
                        Long.</p>
                    <p style="color: var(--text-secondary); font-size: 0.95rem;">Contractors lose deals in the gap
                        between visit &rarr; quote.</p>
                </div>

                <!-- Arrow (Desktop only) -->
                <div class="gap-arrow"
                    style="display: none; position: absolute; top: 40%; left: 31%; font-size: 2rem; color: var(--text-main);">
                    <i class="fa-solid fa-arrow-right"></i>
                </div>

                <!-- Step 2: The Solution -->
                <div class="gap-card"
                    style="text-align: center; padding: 2rem; background: #f8fafc; border-radius: 20px; border: 2px solid var(--primary);">
                    <h3
                        style="color: var(--primary); font-size: 0.9rem; letter-spacing: 1px; text-transform: uppercase; margin-bottom: 0.5rem;">
                        Solution:</h3>
                    <h4 style="color: var(--primary); font-size: 1.5rem; font-weight: 800; margin-bottom: 1.5rem;">
                        INSTANT ON-SITE ESTIMATES</h4>
                    <div class="gap-icon"
                        style="height: 120px; display: flex; align-items: center; justify-content: center; margin-bottom: 1.5rem;">
                        <i class="fa-solid fa-mobile-screen-button" style="font-size: 4rem; color: var(--primary);"></i>
                    </div>
                    <p style="font-weight: 700; margin-bottom: 0.5rem;">Generate it before you leave the driveway.</p>
                    <p style="color: var(--text-secondary); font-size: 0.95rem;"><strong>Win the Bid Before Competitors
                            Even Arrive.</strong> Instant, on-site, personalized estimates that close deals faster.</p>
                </div>

                <!-- Arrow (Desktop only) -->
                <div class="gap-arrow"
                    style="display: none; position: absolute; top: 40%; right: 31%; font-size: 2rem; color: var(--text-main);">
                    <i class="fa-solid fa-arrow-right"></i>
                </div>

                <!-- Step 3: The Outcome -->
                <div class="gap-card" style="text-align: center; padding: 2rem;">
                    <h3
                        style="color: var(--text-secondary); font-size: 0.9rem; letter-spacing: 1px; text-transform: uppercase; margin-bottom: 0.5rem;">
                        Outcome:</h3>
                    <h4 style="color: #22c55e; font-size: 1.5rem; font-weight: 800; margin-bottom: 1.5rem;">SIGNED
                        CONTRACTS</h4>
                    <div class="gap-icon"
                        style="height: 120px; display: flex; align-items: center; justify-content: center; margin-bottom: 1.5rem;">
                        <i class="fa-solid fa-file-signature" style="font-size: 4rem; color: #22c55e;"></i>
                    </div>
                    <p style="font-weight: 700; margin-bottom: 0.5rem;">Turn Every Site Visit Into a Signed Contract.
                    </p>
                    <p style="color: var(--text-secondary); font-size: 0.95rem;">We eliminate that gap.</p>
                </div>
            </div>

            <!-- Sample Render Preview -->
            <div class="sample-render-container" id="what-you-get"
                style="text-align: center; max-width: 900px; margin: 0 auto;">
                <h3 style="margin-bottom: 2rem; font-size: 1.75rem;">What You Generate Instantly:</h3>
                <div class="render-preview-box"
                    style="box-shadow: var(--shadow-xl); border-radius: 12px; overflow: hidden; border: 1px solid var(--border-light);">
                    <img src="images/proposal_sample.jpg" alt="Sample V2R Proposal"
                        style="width: 100%; height: auto; display: block;">
                </div>
                <p style="margin-top: 1.5rem; color: var(--text-secondary);">*Actual output includes branded PDF
                    proposal with cost breakdown.</p>
            </div>
        </div>
    </section>




    <div class="render-output-section" id="render-output" style="display: none;">
        <h3>Your Remodeled Space</h3>
        <div class="render-comparison">
            <div class="render-before">
                <span class="render-label">Before</span>
                <img id="render-before-img" alt="Before">
            </div>
            <div class="render-after">
                <span class="render-label">After</span>
                <div class="render-loading" id="render-loading">
                    <div class="spinner"></div>
                    <p>Creating your visualization...</p>
                    <small>This may take 10-15 seconds</small>
                </div>
                <img id="render-after-img" alt="After" style="display: none;">
            </div>
        </div>
        <div class="render-actions">
            <button type="button" class="btn-secondary" id="try-again-btn">
                <i class="fa-solid fa-rotate-right"></i> Try Another Vision
            </button>
            <a href="vision.html" class="btn-primary">
                <i class="fa-solid fa-paper-plane"></i> Get Professional Quote
            </a>
        </div>
    </div>
    </div>
    </div>
    </section>

    <!-- Value Proposition (Why Choose V2R Builds) -->
    <section id="approach" class="section approach">
        <div class="container">
            <div class="section-header">
                <h2>Why Choose V2R Builds</h2>
                <p>The ultimate sales tool for contractors</p>
            </div>
            <div class="value-grid">
                <div class="value-item fade-in">
                    <div class="value-icon">
                        <i class="fa-solid fa-cube"></i>
                    </div>
                    <h3>3D Visualization</h3>
                    <p>Instantly transform photos into stunning 3D renders to help clients visualize the final result.
                    </p>
                </div>
                <div class="value-item fade-in delay-1">
                    <div class="value-icon">
                        <i class="fa-solid fa-handshake"></i>
                    </div>
                    <h3>Close More Deals</h3>
                    <p>Increase your conversion rate by impressing clients with professional visuals and instant quotes.
                    </p>
                </div>
                <div class="value-item fade-in delay-2">
                    <div class="value-icon">
                        <i class="fa-solid fa-calculator"></i>
                    </div>
                    <h3>Get Accurate Estimates</h3>
                    <p>Generate precise, data-driven cost estimates in seconds to build trust and transparency.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Pricing / Packages Section -->
    <section id="packages" class="section pricing">
        <div class="container">
            <div class="section-header">
                <h2>Our Service Packages</h2>
                <p>From concept to paper to structure â€” bringing your vision to reality with ease</p>
            </div>
            <div class="pricing-grid">
                <!-- Package 1: Vision & Concept - FREE -->
                <div class="pricing-card fade-in">
                    <div class="pricing-badge">Starter</div>
                    <div class="pricing-header">
                        <h3>Vision & Concept</h3>
                        <p class="pricing-subtitle">Perfect for exploring your ideas</p>
                    </div>
                    <div class="pricing-price">
                        <span class="price-amount">Free</span>
                        <span class="price-period">Same day delivery</span>
                    </div>
                    <div class="pricing-features">
                        <h4>What You Get:</h4>
                        <ul>

                            <li><i class="fa-solid fa-check"></i> 3D Visualization</li>
                            <li><i class="fa-solid fa-check"></i> Budget Range Estimate</li>
                            <li><i class="fa-solid fa-check"></i> 1 Live Consultation Call</li>
                        </ul>
                    </div>
                    <div class="pricing-deliverables">
                        <strong>Deliverables:</strong>
                        <p>All PDFs via email or client portal, plus follow-up consultation</p>
                    </div>
                    <a href="#contact" class="btn-secondary pricing-btn">Get Started</a>
                </div>

                <!-- Package 2: Full Design - $299 -->
                <div class="pricing-card featured fade-in delay-1">
                    <div class="pricing-badge popular">Most Popular</div>
                    <div class="pricing-header">
                        <h3>Full Design + Planning</h3>
                        <p class="pricing-subtitle">Complete technical design package</p>
                    </div>
                    <div class="pricing-price">
                        <span class="price-amount">$299</span>
                        <span class="price-period">5-10 day delivery</span>
                    </div>
                    <div class="pricing-features">
                        <h4>Everything in Vision & Concept, Plus:</h4>
                        <ul>
                            <li><i class="fa-solid fa-check"></i> Full Scaled Floor Plans (PDF + DWG)</li>
                            <li><i class="fa-solid fa-check"></i> Technical Drawings & Elevations</li>
                            <li><i class="fa-solid fa-check"></i> Material & Fixtures Schedule</li>
                            <li><i class="fa-solid fa-check"></i> 2-4 Photoreal 3D Renders</li>
                            <li><i class="fa-solid fa-check"></i> Detailed Cost Estimate</li>
                            <li><i class="fa-solid fa-check"></i> Complete Design Book (Branded PDF)</li>
                        </ul>
                    </div>
                    <div class="pricing-deliverables">
                        <strong>Deliverables:</strong>
                        <p>Complete Design Book with all plans, renderings, and materials list</p>
                    </div>
                    <a href="#contact" class="btn-primary pricing-btn">Get Started</a>
                </div>

                <!-- Package 3: Turnkey - $1499 -->
                <div class="pricing-card fade-in delay-2">
                    <div class="pricing-badge">Premium</div>
                    <div class="pricing-header">
                        <h3>Turnkey Management</h3>
                        <p class="pricing-subtitle">Complete project delivery, start to finish</p>
                    </div>
                    <div class="pricing-price">
                        <span class="price-amount">$1,499</span>
                        <span class="price-period">Based on project scope</span>
                    </div>
                    <div class="pricing-features">
                        <h4>Everything in Full Design, Plus:</h4>
                        <ul>
                            <li><i class="fa-solid fa-check"></i> Vendor Sourcing & Management</li>
                            <li><i class="fa-solid fa-check"></i> Procurement Tracking Log</li>
                            <li><i class="fa-solid fa-check"></i> Weekly Progress Reports</li>
                            <li><i class="fa-solid fa-check"></i> Construction Schedule (Gantt Chart)</li>
                            <li><i class="fa-solid fa-check"></i> Quality Control Photo Reports</li>
                            <li><i class="fa-solid fa-check"></i> Final Handover Package</li>
                        </ul>
                    </div>
                    <div class="pricing-deliverables">
                        <strong>Deliverables:</strong>
                        <p>Complete project management with weekly updates and final handover binder</p>
                    </div>
                    <a href="#contact" class="btn-secondary pricing-btn">Get Started</a>
                </div>
            </div>

            <!-- Additional Info -->
            <div class="pricing-footer fade-in delay-3">
                <p><i class="fa-solid fa-circle-info"></i> All packages include clear communication, dedicated
                    support,
                    and our commitment to bringing your vision to reality with utmost ease.</p>
            </div>
        </div>
    </section>

    <!-- CTA / Contact Section -->
    <section id="contact" class="section contact">
        <div class="container contact-container">
            <div class="contact-text fade-in-left">
                <h2>Ready to Transform Your Home?</h2>
                <p>Let V2R Builds bring clarity, confidence, and exceptional results to your next home renovation
                    project.</p>
                <div class="contact-benefits">
                    <span><i class="fa-solid fa-check-circle"></i> Expert Design Consultation</span>
                    <span><i class="fa-solid fa-check-circle"></i> Detailed Project Roadmap</span>
                    <span><i class="fa-solid fa-check-circle"></i> Transparent Cost Analysis</span>
                </div>
                <div class="service-areas">
                    <h4>Serving:</h4>
                    <p>Framingham, Ashland, Auburndale, Cochituate, Cordaville, Dover, Fayville, Holliston,
                        Hopkinton,
                        Hudson, Lincoln, Marlborough, Medfield, and surrounding communities.</p>
                </div>
            </div>
            <div class="contact-form-wrapper glass-card fade-in-right">
                <h3>Start Your Conversation</h3>
                <form class="contact-form" id="contact-form" action="https://formspree.io/f/xyzaplql" method="POST">
                    <div class="form-group">
                        <label for="name">Name</label>
                        <input type="text" id="name" name="name" placeholder="Your Name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" placeholder="Your Email" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone (Optional)</label>
                        <input type="tel" id="phone" name="phone" placeholder="Your Phone Number">
                    </div>
                    <div class="form-group">
                        <label for="project">Project Type</label>
                        <select id="project" name="project_type" required>
                            <option value="">Select a project type</option>
                            <option value="Kitchen Remodel">Kitchen Remodel</option>
                            <option value="Bathroom Renovation">Bathroom Renovation</option>
                            <option value="Basement Finishing">Basement Finishing</option>
                            <option value="Home Addition">Home Addition</option>
                            <option value="ADU">ADU</option>
                            <option value="Complete Transformation">Complete Transformation</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="message">Tell us about your project (Optional)</label>
                        <textarea id="message" name="message" rows="4" placeholder="Describe your vision..."></textarea>
                    </div>
                    <!-- Hidden field for multiple recipients -->
                    <input type="hidden" name="_cc" value="nussharif2020@gmail.com,saifulmahmood@gmail.com">
                    <input type="hidden" name="_subject" value="New V2R Builds Contact Form Submission">
                    <input type="hidden" name="_next" value="thank-you.html">
                    <button type="submit" class="btn-primary full-width">Get Started</button>
                </form>
                <div id="form-status"
                    style="display: none; margin-top: 15px; padding: 15px; border-radius: 10px; text-align: center;">
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="container footer-content">
            <div class="footer-logo">V2R Builds</div>
            <div class="footer-links">
                <a href="#">Privacy Policy</a>
                <a href="#">Terms of Service</a>
            </div>
            <p>&copy; 2025 V2R Builds. All rights reserved.</p>
        </div>
    </footer>

    <!-- Multi-Step Form Modal -->
    <div class="modal-overlay" id="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <span class="modal-title">Start Your Project</span>
                <button class="modal-close" id="modal-close"><i class="fa-solid fa-times"></i></button>
            </div>

            <div class="modal-body">
                <div class="step-indicator">
                    <div class="step-dot active"></div>
                    <div class="step-dot"></div>
                    <div class="step-dot"></div>
                </div>

                <form id="wizard-form" action="https://formspree.io/f/xyzaplql" method="POST">
                    <!-- Step 1: Project Type -->
                    <div class="form-step active" data-step="1">
                        <h3 class="step-question">What type of project are you planning?</h3>
                        <div class="option-grid">
                            <label class="option-card">
                                <input type="radio" name="project_type" value="Kitchen Remodel" hidden required>
                                <div class="option-icon"><i class="fa-solid fa-kitchen-set"></i></div>
                                <span class="option-text">Kitchen Remodel</span>
                            </label>
                            <label class="option-card">
                                <input type="radio" name="project_type" value="Bathroom Renovation" hidden>
                                <div class="option-icon"><i class="fa-solid fa-bath"></i></div>
                                <span class="option-text">Bathroom Renovation</span>
                            </label>
                            <label class="option-card">
                                <input type="radio" name="project_type" value="Basement Finishing" hidden>
                                <div class="option-icon"><i class="fa-solid fa-dungeon"></i></div>
                                <span class="option-text">Basement Finishing</span>
                            </label>
                            <label class="option-card">
                                <input type="radio" name="project_type" value="Home Addition" hidden>
                                <div class="option-icon"><i class="fa-solid fa-house-chimney-medical"></i></div>
                                <span class="option-text">Home Addition</span>
                            </label>
                            <label class="option-card">
                                <input type="radio" name="project_type" value="ADU" hidden>
                                <div class="option-icon"><i class="fa-solid fa-house-user"></i></div>
                                <span class="option-text">ADU</span>
                            </label>
                            <label class="option-card">
                                <input type="radio" name="project_type" value="Complete Transformation" hidden>
                                <div class="option-icon"><i class="fa-solid fa-wand-magic-sparkles"></i></div>
                                <span class="option-text">Complete Transformation</span>
                            </label>
                        </div>
                    </div>

                    <!-- Step 2: Details -->
                    <div class="form-step" data-step="2">
                        <h3 class="step-question">Tell us a bit more about your vision.</h3>
                        <textarea class="form-input" name="message" rows="6"
                            placeholder="What are your goals? Do you have a timeline in mind?" required></textarea>
                    </div>

                    <!-- Step 3: Contact Info -->
                    <div class="form-step" data-step="3">
                        <h3 class="step-question">How can we reach you?</h3>
                        <input type="text" class="form-input" name="name" placeholder="Your Name" required>
                        <input type="email" class="form-input" name="email" placeholder="Your Email" required>
                        <input type="tel" class="form-input" name="phone" placeholder="Phone Number (Optional)">
                    </div>
                </form>
            </div>

            <div class="modal-footer">
                <button class="btn-back" id="btn-back" style="visibility: hidden;">Back</button>
                <button class="btn-next" id="btn-next">Next</button>
            </div>
        </div>
    </div>

    <!-- Instant Rendering Script -->
    <script>
        // Secure API endpoint
        const API_BASE_URL = 'https://v2-r-builds.vercel.app/api';

        document.addEventListener('DOMContentLoaded', () => {
            // Elements
            const uploadBtn = document.getElementById('render-upload-btn');
            const imageInput = document.getElementById('render-image-input');
            const uploadPlaceholder = document.getElementById('render-upload-placeholder');
            const renderPreview = document.getElementById('render-preview');
            const previewImg = document.getElementById('render-preview-img');
            const removeBtn = document.getElementById('render-remove-btn');
            const descriptionTextarea = document.getElementById('render-description');
            const generateBtn = document.getElementById('generate-render-btn');
            const renderOutput = document.getElementById('render-output');
            const renderLoading = document.getElementById('render-loading');
            const beforeImg = document.getElementById('render-before-img');
            const afterImg = document.getElementById('render-after-img');
            const tryAgainBtn = document.getElementById('try-again-btn');

            let selectedFile = null;
            let uploadedImageUrl = null;

            // Upload button click
            uploadBtn.addEventListener('click', () => {
                imageInput.click();
            });

            // File selection
            imageInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file && file.type.startsWith('image/')) {
                    selectedFile = file;
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        previewImg.src = e.target.result;
                        uploadPlaceholder.style.display = 'none';
                        renderPreview.style.display = 'block';
                        checkFormReady();
                    };
                    reader.readAsDataURL(file);
                }
            });

            // Remove image
            removeBtn.addEventListener('click', () => {
                selectedFile = null;
                uploadedImageUrl = null;
                imageInput.value = '';
                uploadPlaceholder.style.display = 'block';
                renderPreview.style.display = 'none';
                checkFormReady();
            });

            // Check if form is ready
            descriptionTextarea.addEventListener('input', checkFormReady);

            function checkFormReady() {
                const hasImage = selectedFile !== null;
                const hasDescription = descriptionTextarea.value.trim().length > 10;
                generateBtn.disabled = !(hasImage && hasDescription);
            }

            // Generate render
            generateBtn.addEventListener('click', async () => {
                try {
                    generateBtn.disabled = true;
                    generateBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Processing...';

                    // Step 1: Upload image to Cloudinary
                    const reader = new FileReader();
                    const base64Promise = new Promise((resolve) => {
                        reader.onload = (e) => resolve(e.target.result);
                        reader.readAsDataURL(selectedFile);
                    });
                    const base64Data = await base64Promise;

                    const uploadResponse = await fetch(`${API_BASE_URL}/upload-image`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            file: base64Data,
                            folder: 'instant-renders',
                            tags: 'instant,auto-delete'
                        })
                    });

                    if (!uploadResponse.ok) {
                        throw new Error('Image upload failed');
                    }

                    const uploadData = await uploadResponse.json();
                    uploadedImageUrl = uploadData.url;

                    // Show output section with loading
                    renderOutput.style.display = 'block';
                    beforeImg.src = uploadedImageUrl;
                    renderLoading.style.display = 'flex';
                    afterImg.style.display = 'none';

                    // Scroll to output
                    renderOutput.scrollIntoView({ behavior: 'smooth', block: 'center' });

                    // Step 2: Generate render via Nano Banana
                    const renderResponse = await fetch(`${API_BASE_URL}/render`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            imageUrl: uploadedImageUrl,
                            userPrompt: descriptionTextarea.value.trim()
                        })
                    });

                    if (!renderResponse.ok) {
                        const errorData = await renderResponse.json();
                        throw new Error(errorData.message || 'Rendering failed');
                    }

                    const renderData = await renderResponse.json();

                    // Show result
                    renderLoading.style.display = 'none';
                    afterImg.src = renderData.renderUrl;
                    afterImg.style.display = 'block';

                    // If we got a description but no new image (Gemini Flash limitation), show it
                    if (renderData.description && renderData.renderUrl === uploadedImageUrl) {
                        const descriptionDiv = document.createElement('div');
                        descriptionDiv.className = 'render-ai-description';

                        // Check if there was a specific fallback reason (e.g. quota exceeded)
                        const fallbackNote = renderData.fallbackReason
                            ? `<span style="color: #d97706; font-weight: 600;"><i class="fa-solid fa-triangle-exclamation"></i> ${renderData.fallbackReason}</span>`
                            : '* Note: Image generation requires an upgraded plan. This is a conceptual description based on your vision.';

                        descriptionDiv.innerHTML = `
                            <div style="background: rgba(255,255,255,0.95); padding: 20px; border-radius: 12px; margin-top: 20px; border-left: 4px solid var(--primary); box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                                <h4 style="margin: 0 0 10px 0; color: var(--primary); display: flex; align-items: center; gap: 8px;">
                                    <i class="fa-solid fa-wand-magic-sparkles"></i> AI Design Concept
                                </h4>
                                <p style="margin: 0; line-height: 1.6; color: var(--text-main); font-size: 0.95rem;">
                                    ${renderData.description.replace(/\n/g, '<br>')}
                                </p>
                                <p style="margin-top: 12px; font-size: 0.8rem; color: var(--text-secondary); font-style: italic;">
                                    ${fallbackNote}
                                </p>
                            </div>
                        `;

                        // Remove existing description if any
                        const existingDesc = renderOutput.querySelector('.render-ai-description');
                        if (existingDesc) existingDesc.remove();

                        renderOutput.querySelector('.render-comparison').after(descriptionDiv);
                    }

                    // Reset button
                    generateBtn.innerHTML = '<i class="fa-solid fa-wand-magic-sparkles"></i> Generate Visualization';
                    generateBtn.disabled = false;

                } catch (error) {
                    console.error('Render error:', error);
                    alert(`Error: ${error.message || 'There was an error creating your visualization.'}`);
                    generateBtn.innerHTML = '<i class="fa-solid fa-wand-magic-sparkles"></i> Generate Visualization';
                    generateBtn.disabled = false;
                    renderOutput.style.display = 'none';
                }
            });

            // Try again button
            tryAgainBtn.addEventListener('click', () => {
                renderOutput.style.display = 'none';
                selectedFile = null;
                uploadedImageUrl = null;
                imageInput.value = '';
                descriptionTextarea.value = '';
                uploadPlaceholder.style.display = 'block';
                renderPreview.style.display = 'none';
                generateBtn.disabled = true;

                // Scroll back to input
                document.getElementById('instant-render').scrollIntoView({ behavior: 'smooth' });
            });
        });
    </script>

    <script src="script.js"></script>
</body>

</html>